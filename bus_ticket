from abc import ABC, abstractmethod 
class vehicle(ABC):
    def __init__ (self,number,total_seats):
        self.number=number
        self.total_seats=total_seats
    @abstractmethod
    def calculation_fare (self,number,total_seats):
        pass

    def show_details(self,number,total_seats):
        print("bus number :",self.number)
        print("total Seats: ",self.total_seats)

class LuxuryBus(vehicle):
    def calculation_fare(self):
        return 500
    
class OrdinaryBus(vehicle):
    def calculation_fare(self):
        return 200
    
class seatmanager:
    def __init__(self, total_seats):
        self.__total_seats = total_seats  # Private variable
        self.__booked_seats = []

    def book_seat(self):
        if len(self.__booked_seats) < self.__total_seats:
            seat_no = len(self.__booked_seats) + 1
            self.__booked_seats.append(seat_no)
            return seat_no
        return None
    
    def cancel_seat(self, seat_no):
        if seat_no in self.__booked_seats:
            self.__booked_seats.remove(seat_no)
            return True
        return False

    def available_seats(self):
        return self.__total_seats - len(self.__booked_seats)
    
class passenger:
    def __init__(self,name,age):
        self.name=name
        self.age=age

class ticket:
    def __int__(self,passenger,bus,seat_no,fare):
        self.passenger=passenger
        self.bus=bus
        self.seat_no=seat_no
        self.fare=fare

    def show_ticket(self):
        print("-" * 30)
        print(f"TICKET CONFIRMED")
        print(f"Passenger: {self.passenger.name} ({self.passenger.age})")
        print(f"Bus: {self.bus.number} | Seat: {self.seat_no}")
        print(f"Fare Paid: â‚¹{self.fare}")
        print("-" * 30)

print("Welcom to bus booking system")
print("\n Bus types : 1.Luxury Bus  2.Ordinary Bus")
op=input("Enter the bus type")

if op == '1':
    my_bus = LuxuryBus("LX-101", 5)
else:
    my_bus = OrdinaryBus("ORD-202", 5)

sm = seatmanager(my_bus.total_seats)
tickets_list=[]

while True:
    print("\n 1.Available seats 2.book seat 3.cancel seat 4.show ticket 5.exit")
    choice=input("Enter the option :")

    if op == '1': # STEP 21
        print("Seats Remaining :", sm.available_seats())

    elif op == '2': # STEP 22
        name = input("Enter Name: ")
        age = input("Enter Age: ")
        
        seat = sm.book_seat()
        if seat:
            p = Passenger(name, age)
            fare = my_bus.calculate_fare() 
            new_ticket = Ticket(p, my_bus, seat, fare)
            tickets_list.append(new_ticket)
            new_ticket.show_ticket()
        else:
            print("Error: Bus is Full!")

    elif op == '3':
        s_no = int(input("Enter seat number to cancel: "))
        if sm.cancel_seat(s_no):
            print("Seat cancelled successfully :",s_no)

            tickets_list = [t for t in tickets_list if t.seat_no != s_no]
        else:
            print("Invalid Seat Number.")

    elif op == '4':
        if not tickets_list:
            print("No tickets booked yet.")
        for t in tickets_list:
            t.show_ticket()

    elif op == '5': 
        print("Thank you for using our system!")
        break
        
        

